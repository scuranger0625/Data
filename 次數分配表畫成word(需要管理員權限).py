from docx import Document
from docx.shared import Inches
import os

# 創建一個新的 Word 文件
doc = Document()

# 添加標題
doc.add_heading('人口統計資料', level=1)

# 添加表格
data = [
    ('性別', [
        ('男', 408, '40.6%'),
        ('女', 596, '59.4%')
    ]),
    ('年齡', [
        
        ('20-29歲', 10, '16.949153%'),
        ('30-39歲', 10, '16.949153%'),
        ('40-49歲', 10, '16.949153%'),   
        ('50歲以上', 29, '49.152542%')
    
        
        
    ]),
    ('出生地', [
        ('基隆市', 12, '1.2%'),
        ('台北市', 158, '15.7%'),
        ('新北市', 127, '12.6%'),
        ('桃園市', 53, '5.3%'),
        ('新竹縣', 9, '0.9%'),
        ('新竹市', 24, '2.4%'),
        ('苗栗縣', 31, '3.1%'),
        ('南投縣', 22, '2.2%'),
        ('台中市', 80, '8.0%'),
        ('彰化縣', 83, '8.3%'),
        ('雲林縣', 44, '4.4%'),
        ('嘉義縣', 26, '2.6%'),
        ('嘉義市', 13, '1.3%'),
        ('台南市', 95, '9.5%'),
        ('高雄市', 112, '11.2%'),
        ('屏東縣', 53, '5.3%'),
        ('宜蘭縣', 30, '3.0%'),
        ('花蓮縣', 16, '1.6%'),
        ('台東縣', 6, '0.6%'),
        ('其他', 10, '1.0%')
    ]),
    ('教育程度', [
        ('無', 1, '0.1%'),
        ('小學', 1, '0.1%'),
        ('國(初)中', 17, '1.7%'),
        ('高中普通科', 13, '1.3%'),
        ('高中職業科', 52, '5.2%'),
        ('高職(高商、高工)', 71, '7.1%'),
        ('士官學校', 1, '0.1%'),
        ('五專', 36, '3.6%'),
        ('二專', 75, '7.5%'),
        ('三專', 5, '0.5%'),
        ('軍警專修班', 1, '0.1%'),
        ('軍警專科班', 2, '0.2%'),
        ('空中行專', 1, '0.1%'),
        ('空中大學', 7, '0.7%'),
        ('軍警官校或大學', 15, '1.5%'),
        ('技術學院、科大', 170, '16.9%'),
        ('大學', 367, '36.6%'),
        ('碩士', 157, '15.6%'),
        ('博士', 12, '1.2%')
    ])
]

# 添加每個分類的表格
for category, items in data:
    doc.add_heading(f'{category}次數分配表:', level=2)
    table = doc.add_table(rows=1, cols=4)
    table.style = 'Table Grid'
    hdr_cells = table.rows[0].cells
    hdr_cells[0].text = '項目'
    hdr_cells[1].text = '次數'
    hdr_cells[2].text = '百分比'
    for item, count, percent in items:
        row_cells = table.add_row().cells
        row_cells[0].text = item
        row_cells[1].text = str(count)
        row_cells[2].text = percent

# 設定文件路徑
desktop_path = os.path.join(os.path.join(os.environ['USERPROFILE']), 'Desktop')
file_path = os.path.join(desktop_path, '人口統計資料.docx')

# 儲存文件
doc.save(file_path)







